# TBLASTX テスト結果比較

## テスト実行日時
2024-12-28 (修正後)

## 結果サマリー

| テストケース | LOSAT hits | NCBI hits | 比率 | 低同一性(<50%) LOSAT | 低同一性(<50%) NCBI | 低同一性比率 |
|------------|-----------|----------|------|---------------------|---------------------|------------|
| NZ_CP006932 self | 13,850 | 62,053 | 22.31% | 566 | 26,070 | 2.17% |
| AP027132 vs NZ_CP006932 | 14,015 | 62,575 | 22.39% | 523 | 27,325 | 1.91% |
| AP027078 vs AP027131 | 2,609 | 30,175 | 8.64% | 194 | 17,361 | 1.12% |
| AP027131 vs AP027133 | 3,030 | 14,871 | 20.37% | 140 | 9,503 | 1.47% |
| AP027133 vs AP027132 | 15,121 | 54,864 | 27.56% | 465 | 25,049 | 1.86% |

## 主な観察事項

### 1. ヒット数の比較
- LOSATはNCBI BLASTの8.64%〜27.56%のヒットを検出（平均約20%）
- 特に低同一性ヒット（<50%）の検出率が極めて低い（1.12%〜2.17%）
- NCBI BLASTは低同一性ヒットを大量に検出しているが、LOSATはほとんど検出していない

### 2. 同一性分布の比較

#### NZ_CP006932 self
- LOSAT: <50%: 566 (4.1%), 50-80%: 8,784 (63.4%), >=80%: 4,500 (32.5%)
- NCBI: <50%: 26,070 (42.0%), 50-80%: 19,104 (30.8%), >=80%: 16,879 (27.2%)
- **問題**: 低同一性ヒットが大幅に不足（566 vs 26,070）

#### AP027132 vs NZ_CP006932
- LOSAT: <50%: 523 (3.7%), 50-80%: 8,553 (61.0%), >=80%: 4,939 (35.2%)
- NCBI: <50%: 27,325 (43.7%), 50-80%: 19,719 (31.5%), >=80%: 15,531 (24.8%)
- **問題**: 低同一性ヒットが大幅に不足（523 vs 27,325）

### 3. ビットスコアの比較
- LOSAT最小ビットスコア: 32.3
- NCBI最小ビットスコア: 22.1
- **問題**: LOSATは22.1ビットスコアのヒットを検出していない（cutoff_scoreが高すぎる可能性）

### 4. アライメント長の比較
- LOSAT平均長: 41.1〜130.1
- NCBI平均長: 40.9〜42.8
- **観察**: LOSATは長いアライメントを多く検出しているが、短いアライメント（特に低スコアのもの）が不足

## 問題の分析

### cutoff_scoreによるフィルタリング
1. **gap_trigger=46 (raw score)** が `cutoff_score` を制限している可能性
2. **最小ビットスコア32.3** は、gap_trigger (22.0 bit score ≈ 46 raw score) よりも高い
3. **低同一性ヒットの不足** は、これらのヒットが低スコアであるため、cutoff_scoreでフィルタリングされている可能性が高い

### 期待される改善
- `cutoff_score_max` が `gap_trigger` よりも小さい場合、より低スコアのヒットが通過できるはず
- しかし、現在の結果では、cutoff_scoreが依然として高すぎる可能性がある

## 次のステップ

1. **診断ログの確認**: cutoff_scoreの実際の値を確認
2. **cutoff_score_maxの検証**: eff_searchspを使用した計算が正しいか確認
3. **低スコアヒットの分析**: 22.1ビットスコア付近のヒットがなぜ検出されないか調査


